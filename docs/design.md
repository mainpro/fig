# 设计文档

## 一、产品概述

### 1.1 产品定位

本低代码平台聚焦小微企业需求，直击传统低代码产品痛点。
依托可视化操作与丰富功能模块，它能大幅压缩产品原型搭建时长，快速落地基础功能；
同时，借助代码生成与集成能力，还能助力专业开发者攻克复杂功能开发难题，全方位缩短开发周期。

### 1.2 目标用户

核心用户定位为小微企业，覆盖无开发基础的业务人员与专业开发者两大群体。

对于业务人员来说，低代码平台凭借直观的可视化操作界面，极大降低了系统开发门槛。
无需掌握复杂编程知识，通过简单的拖拽、配置等操作，就能快速搭建贴合业务需求的信息化系统，
将业务想法高效转化为实际可用的系统功能，迅速满足日常业务运转所需。

而专业开发者则能依托平台强大的自定义基础能力，在业务人员搭建的系统原型基础上大展身手。
平台生成的标准代码结构清晰、可读性强，开发者可以此为起点，深入进行二次开发与系统优化。
无论是拓展复杂业务逻辑，还是优化系统性能，都能更高效地实现，让系统在满足基础业务需求的同时，进一步适应企业多样化、复杂化的发展需求 。

## 关键概念

- 空间： 平台使用空间对业务域进行隔离。

## 二、系统流程设计

### 2.1 整体业务流程

```mermaid
---
title: 整体业务流程
---
flowchart LR
开始([开始]) -->
创建空间 -->
设计数据模型 -->
设计表单 --> 
设计流程--> 
收集数据 -->
分析数据 -->
结束([结束])
```

#### 2.1.1 空间创建

用户完成平台登录认证后，进入空间管理模块，通过系统提供的创建功能生成独立业务空间。
各空间具备数据隔离与权限独立特性，为后续业务系统搭建提供安全、专属的运行环境。

#### 2.1.2 数据模型设计

用户在业务空间内通过可视化工具创建数据模型。
可拖拽生成实体，配置属性时支持基础数据类型、枚举值与关联字段。
通过函数表达式设置计算规则（如日期自动计算）与约束条件（如必填校验），实现动态属性值与复杂逻辑验证。
系统提供版本管理，自动记录迭代历史，支持版本回溯、对比及无缝数据迁移。
通过表达式与约束保障数据完整性，灵活适应业务变化，确保模型迭代可追溯、可管控。

#### 2.1.3 表单设计

基于已构建的数据模型，用户通过拖拽式操作快速生成并定制表单。
支持字段布局调整、分组管理，高效实现从数据模型到表单界面的转化。
在权限管理上，依托基于角色的权限控制体系，实现表单字段级别的查看、编辑、隐藏权限分配。
针对复杂业务场景，支持关联表单设计，允许用户嵌入子表单结构，实现多层级数据管理与交互。

#### 2.1.4 函数开发

用户进入函数开发界面，可选择图形化或代码模式。
图形化模式下，通过拖拽逻辑组件搭建函数；代码模式支持代码高亮与智能补全。
开发后可在沙盒测试，自定义数据集调试，系统记录性能并提示错误。
函数存于库中，按业务分类，支持导入导出与版本管理，常用函数可封装复用。
基于角色设权限，记录调用日志。函数能与平台各模块集成，支持对接外部服务，还可通过插件扩展、AI 辅助生成。

#### 2.1.5 流程设计

当业务场景涉及流程化管理时，用户可进入可视化流程设计模块进行流程编排。
通过添加开始节点、任务节点、审批节点、分支节点、结束节点等流程元素，并配置节点负责人、处理时限、操作权限等属性，完成基础流程架构搭建；
同时可设置手动触发、定时触发、数据变更触发等多种流程启动方式，以及基于审批结果、数据条件的动态跳转规则，实现业务流程的灵活流转。
系统提供流程实时监控功能，支持查看流程进度、节点状态及历史操作记录，便于流程运行状态跟踪与异常处理。

#### 2.1.6 表单提交与数据处理

用户完成表单设计后，将表单发布至业务空间，并通过系统邀请功能向指定人员或群组发送填写邀请；
被邀请用户进入填写页面后，系统依据数据模型预设验证规则自动化校验输入数据，实时拦截不合规数据并提示修正，
提交成功后按预先配置自动触发流程启动、数据更新等后续操作；
针对批量数据录入支持 Excel 导入与批量提交，且在数据收集全程，系统实时向发布者反馈提交状态及结果信息。

#### 2.1.7 数据分析与应用

数据成功存储至系统数据库后，用户可通过数据分析模块进行数据价值挖掘。
支持基于表单数据快速创建可视化报表，提供柱状图、折线图、饼图、仪表盘等多种图表类型，并可进行报表样式定制与布局调整。
用户可根据业务需求自主设定查询条件、过滤规则，实现数据的灵活筛选与检索；
同时支持数据钻取与多报表联动分析，满足不同层级的数据分析需求。分析结果支持导出为Excel、PDF、CSV 等常见文件格式，
并可通过权限设置实现数据共享，为企业决策提供数据支撑。

### 2.2 关键功能流程

#### 2.2.1 数据模型设计流程

用户进入数据模型设计界面，在实体列表区点击 “新建实体” 按钮，系统弹出实体属性对话框，用户输入实体名称、编码、描述信息后确认创建。
在属性编辑区，用户可通过“添加属性” 功能为实体添加字段，支持下拉选择基础数据类型（文本 / 数值 / 日期等）、枚举类型或关联其他实体字段。
设置验证规则时，系统提供可视化表达式编辑器，用户可通过拖拽操作组合逻辑条件（如 “长度不超过 50字符”、“必须为正整数”），或直接编写自定义表达式。
通过关系连线区，用户点击实体间的连线按钮，系统弹出关系配置面板，支持设置一对一、一对多、多对多关系，配置关联字段和级联操作规则。
实时预览区采用树形结构同步展示模型层级，用户可切换不同视图模式（列表视图 /关系图视图）。
完成设计后点击保存，系统自动生成版本号，记录变更内容，支持版本对比（高亮显示增删改字段）和回滚操作。

#### 2.2.2 表单设计流程

用户选择已创建的数据模型，系统基于实体 - 属性结构自动映射生成表单字段，默认布局为垂直排列。
在表单设计界面，用户可通过左侧组件库拖拽字段调整顺序，使用“分组” 功能创建字段集合，支持嵌套分组。
系统提供多种布局模板（卡片式 / 表格式 / 标签页式），用户可一键应用。
在权限设置模块，基于 RBAC 模型，用户可选择预设角色（管理员 / 审批人 / 填报人）或自定义角色，配置字段级权限（查看 / 编辑 /
隐藏），支持条件权限设置（如 “部门经理可编辑金额字段”）。
对于复杂业务场景，用户点击 “添加子表单”按钮，系统弹出数据模型选择器，支持关联多级子表结构，设置主子表关联字段。
设计过程中，右侧实时预览区提供 PC 端 / 移动端双模式预览，用户可调整预览窗口尺寸检查响应式效果。
完成设计后点击保存，系统自动校验表单配置完整性（如必填字段检查、权限冲突检测）。

#### 2.2.3 流程设计流程

用户进入流程设计界面，从左侧元素库拖拽开始 / 结束节点至画布，系统自动生成唯一节点ID。
添加任务节点时，用户可选择任务类型（人工任务 / 自动任务），在属性配置区设置节点名称、处理人（支持指定用户 / 角色 /
部门）、处理时限（精确到分钟）、超时策略（自动转办 / 发送提醒）。
配置审批节点时，系统提供审批策略选择器（单人审批 / 会签 / 或签），支持设置审批意见类型（同意 / 不同意 / 弃权）。
在分支节点属性配置区，用户可通过表达式编辑器设置跳转条件（如 “金额> 1000 转总经理审批”），支持多条件组合。
配置流程触发方式时，支持选择手动触发 / 定时触发（Cron 表达式配置）/ 数据变更触发（监听指定实体字段变化）。
设计完成后，用户点击 “流程模拟”按钮，系统弹出模拟测试面板，用户可设置测试数据，系统按配置路径执行流程，
实时显示节点执行状态（已执行 / 当前执行 / 待执行），记录执行日志（包含节点处理时间、处理人、操作记录）。
模拟无误后点击保存，系统生成流程定义文件，支持导出为标准 BPMN 格式。

## 三、视图设计

### 3.1 数据模型设计视图

数据模型功能主要涵盖列表页和编辑页两大模块，为用户提供从实体管理到编辑的全流程操作体验，满足多样化的数据建模需求。

#### 列表页

列表页以简洁清晰的表格形式呈现实体的基本信息，展示字段包括实体名称、编码、创建时间等关键内容。
页面顶部设置搜索框与标签过滤栏，用户在搜索框内输入实体名称或关键词，系统将实时筛选出匹配的实体；
通过勾选标签过滤栏中的不同标签（如业务分类标签），可快速精准定位特定类型的实体，实现高效的数据检索。

列表页右上角设有 “关系视图” 切换按钮，点击该按钮后，页面布局随即改变。
原列表页的表格将移动至左侧区域，此时表格仅展示实体名称、关键标识等少量必要信息，为右侧区域腾出空间。
右侧区域会自动生成并展示对应实体间的ER 图，直观呈现实体关系网络。在关系视图状态下，
用户可通过勾选左侧表格中的实体，灵活控制右侧 ER图中展示的实体范围，便于聚焦查看特定实体间的关系，提升数据分析的针对性。

此外，表格中每个实体所在行均配备 “编辑” 按钮，用户点击该按钮，即可直接跳转至实体编辑页面，对选中实体进行深入细致的修改操作，无缝衔接不同功能模块。

#### 编辑页

实体编辑页面为用户提供 jsonSchema 编辑与图形化编辑两种模式，用户可根据自身操作习惯和业务需求，通过页面顶部的切换按钮轻松实现模式切换。

在 jsonSchema 编辑模式下，页面提供专业的代码编辑区域，用户能够直接编写 jsonSchema 代码，对实体结构、属性配置等内容进行定义。
编辑区域具备代码高亮、智能提示功能，不仅使代码结构更加清晰易读，还能辅助用户快速准确地编写代码，有效提升编辑效率和代码质量。

图形化编辑模式则采用可视化操作界面，降低操作门槛，让用户更直观地构建实体。
用户可通过点击 “添加属性” 按钮，从文本、数值等多种属性类型中进行选择，并配置属性约束条件，如设置必填项、长度限制等；
还能添加表达式，用于自动计算属性值等复杂逻辑，轻松应对各类业务场景下的属性设置需求。

编辑页面设有 “实体类型” 配置模块，用户可通过下拉菜单，从基础实体、关联实体等多种类型中进行选择，精准定义实体性质。
在属性编辑区域，针对每个属性，用户均可详细设置属性类型、约束规则以及表达式逻辑，
确保数据模型能够全方位满足复杂业务场景下的严格定义需求，为后续的数据处理和业务运行奠定坚实基础。

### 3.2 表单设计视图

页面上方是表单预览区域，实时展示表单设计效果。中间部分为表单编辑区，用户可将字段从右侧的数据字段列表拖拽到编辑区，进行布局调整和样式设置。右侧设有样式定制面板、字段权限设置面板和关联表单设计面板，用户可分别进行表单样式定制、权限配置和关联表单操作。

### 3.3 流程设计视图

全屏展示可视化流程画布，流程元素以图形化图标呈现，节点间通过箭头连线表示流程走向。右侧为节点属性配置面板，用户选中某个节点时，面板显示该节点的详细属性设置项。上方设有流程触发方式设置栏和流程模拟运行按钮，方便用户配置触发条件和测试流程逻辑。

### 3.4 数据分析视图

界面左侧为数据报表导航栏，按报表类型或业务分类展示已创建的报表。中间区域是报表展示区，根据用户选择的报表类型以可视化图形呈现数据。右侧设有查询过滤条件设置面板和数据钻取操作面板，用户可设置查询条件、进行数据钻取和联动分析。底部提供数据导出和共享操作按钮。

## 四、交互逻辑设计

### 4.1 数据模型设计交互逻辑

用户创建或修改数据实体、属性及关系时，系统实时更新可视化建模画布和属性编辑面板内容，确保操作与展示同步。当用户保存数据模型版本时，系统自动记录变更内容，生成版本历史记录，用户点击版本管理栏的版本切换按钮，可切换查看不同版本的模型结构，并对比差异。

### 4.2 表单设计交互逻辑

用户在表单编辑区拖拽字段进行布局调整时，表单预览区域实时显示调整效果。在样式定制面板修改样式属性后，表单预览区域即时应用新样式。设置字段权限时，系统根据用户选择的角色和权限设置，在表单预览区域模拟不同角色的字段显示和操作状态。

### 4.3 流程设计交互逻辑

用户在流程画布上添加、移动或删除流程元素时，系统自动更新箭头连线，保持流程逻辑连贯。配置节点属性和跳转规则后，点击流程模拟运行按钮，系统以动画形式展示流程运行路径，高亮显示当前执行节点，方便用户检查逻辑错误。

### 4.4 数据分析交互逻辑

用户在查询过滤条件设置面板输入或选择条件后，报表展示区实时刷新数据。进行数据钻取操作时，系统根据钻取规则加载并展示下一级数据。点击数据导出按钮，弹出文件格式选择框，用户选择格式后系统生成对应文件供下载；点击数据共享按钮，弹出共享设置弹窗，用户可设置共享对象和权限。

## 五、功能需求详细设计

### 5.1 数据模型设计功能

#### 5.1.1 可视化建模

支持鼠标拖拽创建、删除、移动数据实体，实体间通过拖拽连线建立关系，连线可标注关系类型。属性编辑支持双击属性名称进行修改，下拉选择数据类型，输入框设置验证规则。实时预览区可切换不同视角查看模型结构，支持放大、缩小操作。

#### 5.1.2 多类型数据支持

除常见基础数据类型外，枚举类型支持自定义取值列表，关联字段支持选择已创建的数据实体建立关联关系，关联关系可设置级联操作（如级联删除）。

#### 5.1.3 数据验证规则设置

基础验证规则通过勾选或下拉选择设置，复杂条件约束支持使用表达式编辑器编写逻辑表达式，表达式编写过程中提供字段引用提示和语法检查功能。

#### 5.1.4 数据模型版本管理

版本历史记录以时间轴形式展示，每条记录包含版本号、修改时间、修改人、修改内容摘要。版本回溯支持一键恢复到指定版本，数据迁移配置界面提供可视化映射设置工具，方便用户配置数据转换规则。

### 5.2 表单设计功能

#### 5.2.1 拖拽式表单搭建

字段列表支持搜索功能，拖拽字段时显示智能吸附线辅助布局。分组管理支持创建、删除分组，设置分组标题和样式。字段显示方式切换通过右键菜单或属性面板操作，实时在表单预览区展示效果。

#### 5.2.2 表单样式开发定制

提供预设样式模板库，用户可直接选择应用。自定义样式时，支持设置背景颜色、边框样式、内边距、外边距等属性，可实时预览样式效果，保存自定义样式供后续项目复用。

#### 5.2.3 字段权限控制

权限设置界面以表格形式展示用户角色和字段权限，支持批量设置权限。通过勾选或下拉选择设置查看、编辑、隐藏权限，设置完成后可在表单预览区模拟不同角色访问效果。

#### 5.2.4 关联表单设计

支持在表单中嵌入多个子表单，子表单可独立设置显示样式和操作权限。关联关系设置通过选择主表单字段和子表单关联字段建立，支持一对多、多对多关联关系配置。

### 5.3 流程设计功能

#### 5.3.1 可视化流程编排

流程元素库分类展示各类流程元素，支持搜索功能。拖拽元素到画布时自动吸附到合适位置，元素间连线支持自动布局和手动调整。节点属性配置面板提供丰富的属性设置项，如任务节点可设置任务描述、附件上传等功能。

#### 5.3.2 多种流程触发方式

触发方式设置界面以选项卡形式展示手动、定时、数据变更等触发方式，每种触发方式提供详细配置项。定时触发支持设置 cron
表达式，数据变更触发支持选择数据实体和变更字段，设置变更条件。

#### 5.3.3 流程跳转规则配置

跳转规则设置通过图形化条件编辑器完成，支持添加、删除、修改条件分支。条件表达式编写支持字段引用和逻辑运算，设置完成后可通过流程模拟运行验证跳转逻辑。

#### 5.3.4 流程监控与跟踪

流程监控界面以列表形式展示正在运行的流程实例，显示流程名称、当前节点、负责人、开始时间等信息。点击流程实例可查看详细流程执行日志，包括每个节点的操作时间、操作人、操作内容等，支持按时间、节点等条件筛选日志。

### 5.4 表单提交功能

#### 5.4.1 数据提交校验

提交表单时，系统按数据模型预设的验证规则依次校验每个字段，校验不通过时在对应字段旁显示错误提示信息，提示信息可自定义文案。错误提示支持聚焦到对应字段，方便用户修改。

#### 5.4.2 提交后动作执行

提交后动作设置界面以列表形式展示可执行的动作类型，如触发流程、更新数据、发送提醒等。每个动作类型提供详细配置项，如触发流程可选择要触发的具体流程，发送提醒可设置提醒方式（邮件、短信等）、接收人等。

#### 5.4.3 批量提交与导入

批量提交支持按住 Ctrl 键或 Shift 键多选表单数据，点击批量提交按钮统一提交。Excel
数据导入提供模板下载功能，用户按模板填写数据后上传，系统自动校验数据格式，导入完成后显示导入结果报告，包括成功导入数据条数、失败数据及原因。

#### 5.4.4 提交状态反馈

提交表单后，页面顶部弹出提交状态提示框，显示提交成功或失败信息。若提交失败，提示框内提供查看详细错误信息按钮，点击后在页面下方展开错误信息详情页，详细说明失败原因和解决建议。

### 5.5 数据分析功能

#### 5.5.1 可视化报表生成

报表创建向导分步骤引导用户操作，包括选择数据源、报表类型、设置展示字段和筛选条件。每种报表类型提供多种布局模板，用户可选择应用。报表生成后，支持在报表展示区通过右键菜单或属性面板修改图表样式、颜色、标题等属性。

#### 5.5.2 自定义查询与过滤

查询过滤条件设置面板支持添加、删除、修改查询条件，条件之间可设置逻辑关系（与、或）。支持保存常用查询方案，保存时可设置方案名称和描述，方便下次快速调用。

#### 5.5.3 数据钻取与联动

数据钻取通过在报表图形上点击数据点触发，系统根据钻取规则加载下一级数据并展示。多报表联动支持选择关联字段，当一个报表的数据发生变化时，其他关联报表自动刷新展示相关数据。

#### 5.5.4 数据导出与共享

数据导出支持选择 Excel、PDF、CSV 等文件格式，导出时可设置文件名称和数据范围。数据共享支持通过链接共享和用户 /
部门共享两种方式，链接共享可设置链接有效期和访问密码，用户 / 部门共享可设置共享对象的查看、编辑、下载权限。

### 5.6 版本控制功能

#### 5.6.1 编辑历史记录

编辑历史记录界面以列表形式展示所有设计内容的编辑操作，包括数据模型、表单、流程等。每条记录包含操作时间、操作人、操作类型（创建、修改、删除等）、操作内容摘要，支持按时间、操作人、操作类型等条件筛选记录。

#### 5.6.2 版本发布管理

版本发布界面显示待发布的设计内容，用户可添加发布说明，设置审核流程（如提交给指定人员审核）和发布范围（全公司、特定部门或用户）。发布完成后，记录发布时间、发布人、发布内容等信息，方便追溯。

#### 5.6.3 版本间数据迁移

版本间数据迁移界面提供源版本和目标版本选择，用户可查看两个版本的数据结构差异。通过可视化映射工具，将源版本的数据字段映射到目标版本的对应字段，设置数据转换规则，完成后可进行数据迁移测试，确保数据准确迁移。

#### 5.6.4 版本回滚操作

版本回滚界面列出所有可回滚的版本，用户选择要回滚的版本后，系统提示回滚操作将覆盖当前设计内容和数据，确认后执行回滚操作，并记录回滚时间、回滚人等信息。
这份文档从多维度向开发者清晰阐述了产品设计。
